# 🎯 TimetableEditModal 드래그 앤 드롭 기능 구현 계획

## 📋 **개요**
`TimetableEditModal`에서 수업 카드를 시간표 셀로 드래그하여 추가할 수 있는 기능을 구현합니다. 클릭으로 추가하는 기능은 제거하고 드래그 앤 드롭만으로 수업을 추가하며, 시간 충돌 검증도 포함됩니다.

## 🚀 **구현 단계**

### **1단계: 라이브러리 설치 및 설정**
- **목표**: react-dnd 라이브러리 설치 및 기본 설정
- **작업 내용**:
  ```bash
  npm install react-dnd react-dnd-html5-backend
  ```
- **파일 수정**:
  - `src/App.tsx` 또는 최상위 컴포넌트에 DndProvider 추가
  - HTML5Backend 설정

### **2단계: 드래그 가능한 수업 카드 구현**
- **목표**: 수업 카드를 드래그할 수 있도록 설정
- **작업 내용**:
  - `renderClassCard` 함수에 `useDrag` 훅 적용
  - 드래그 데이터 설정 (수업 ID, 수업 정보)
  - 드래그 중 시각적 피드백 추가
- **파일 수정**:
  - `TimetableEditModal.tsx`
  - `TimetableEditModal.css` (드래그 스타일 추가)

### **3단계: TimetableWidget 전체 드롭 존 구현**
- **목표**: TimetableWidget 전체를 하나의 드롭 존으로 설정
- **작업 내용**:
  - `TimetableWidget` 컴포넌트 전체에 드롭 존 추가
  - 단일 드롭 이벤트로 모든 수업 추가 처리
  - 드롭 가능한 영역 시각적 표시
- **파일 수정**:
  - `TimetableWidget.tsx`
  - `TimetableWidget.css`

### **4단계: 드롭 이벤트 처리 및 자동 배치**
- **목표**: 드롭 시 수업 카드의 스케줄 정보를 파싱하여 자동 배치
- **작업 내용**:
  - `useDrop` 훅에서 드롭 이벤트 처리
  - 수업 카드의 스케줄 정보 자동 파싱
  - 요일과 시간대에 맞게 자동으로 시간표에 배치
  - 시간 충돌 검증 (`checkAllConflicts` 활용)
  - 충돌 시 에러 메시지 표시
- **파일 수정**:
  - `TimetableEditModal.tsx`
  - `TimetableWidget.tsx`

### **5단계: 드래그 앤 드롭 시각적 피드백**
- **목표**: 사용자에게 직관적인 드래그 앤 드롭 경험 제공
- **작업 내용**:
  - 드래그 중인 수업 카드 스타일링
  - 드롭 가능한 영역 하이라이트
  - 드롭 불가능한 영역 표시
  - 드래그 중 커서 변경
- **파일 수정**:
  - `TimetableEditModal.css`
  - `TimetableWidget.css`

### **6단계: 드래그 앤 드롭 전용 UI 구현**
- **목표**: 드래그 앤 드롭만으로 수업 추가하는 직관적인 인터페이스 구현
- **작업 내용**:
  - 클릭 이벤트 완전 제거
  - 드래그 앤 드롭 전용 UI/UX 구현
  - 사용자 안내 메시지 업데이트

## 🔧 **기술적 세부사항**

### **DnD 데이터 구조**
```typescript
// 드래그 데이터 타입
interface DragItem {
  type: 'class-section'
  classSection: ClassSectionWithDetails
  id: string
}

// 드롭 처리 결과 (자동 배치)
interface DropResult {
  success: boolean
  message: string
  conflicts?: Array<{
    dayOfWeek: string
    conflictingTime: string
    conflictingClass: string
    message: string
  }>
}
```

### **충돌 검증 및 자동 배치 처리**
- 기존 `checkAllConflicts` 함수 재사용
- 드롭 시 수업 카드의 스케줄 정보 자동 파싱
- 요일과 시간대에 맞게 자동으로 시간표에 배치
- 충돌 발생 시 드롭 거부 및 에러 메시지 표시
- 드래그 앤 드롭 전용 수업 추가 로직 구현

### **상태 관리**
- 드래그 중인 수업 정보 상태
- 드롭 가능한 영역 하이라이트 상태
- 드래그 앤 드롭 진행 상태

## 📁 **수정될 파일 목록**

### **주요 수정 파일**
1. `TimetableEditModal.tsx` - 드래그 앤 드롭 로직 구현
2. `TimetableWidget.tsx` - 드롭 존 및 드롭 이벤트 처리
3. `TimetableEditModal.css` - 드래그 관련 스타일
4. `TimetableWidget.css` - 드롭 존 스타일

### **설정 파일**
1. `App.tsx` 또는 최상위 컴포넌트 - DndProvider 설정
2. `package.json` - react-dnd 의존성 추가

## 🎨 **UI/UX 개선사항**

### **드래그 중 피드백**
- 수업 카드 투명도 조정
- 드래그 중인 카드 그림자 효과
- 커서 스타일 변경 (grab → grabbing)

### **드롭 영역 표시**
- TimetableWidget 전체 드롭 가능 영역 하이라이트
- 드롭 중 시각적 피드백
- 호버 시 드롭 가능 여부 안내

### **에러 처리**
- 시간 충돌 시 시각적 피드백
- 드롭 실패 시 원래 위치로 복귀
- 명확한 에러 메시지 표시

## 🧪 **테스트 계획**

### **기능 테스트**
1. 수업 카드 드래그 가능 여부
2. TimetableWidget 전체에 드롭 성공/실패
3. 수업 카드 스케줄 정보 자동 파싱 및 배치
4. 시간 충돌 검증 정상 작동
5. 드래그 앤 드롭 전용 인터페이스 정상 작동

### **사용자 경험 테스트**
1. 드래그 앤 드롭 직관성
2. 시각적 피드백의 명확성
3. 에러 상황에서의 사용자 안내

## ⚠️ **주의사항**

### **성능 고려사항**
- 드래그 중 불필요한 리렌더링 방지
- 드롭 존 계산 최적화
- 메모리 누수 방지

### **접근성**
- 키보드 네비게이션 지원
- 스크린 리더 호환성
- 드래그 앤 드롭 대안 제공

### **브라우저 호환성**
- HTML5 드래그 앤 드롭 지원 브라우저 확인
- 터치 디바이스 대응 방안 검토

## 📅 **예상 소요 시간**

- **1-2단계**: 2-3시간
- **3-4단계**: 3-4시간 (전체 드롭 존으로 단순화)
- **5-6단계**: 2-3시간
- **테스트 및 디버깅**: 2-3시간
- **총 예상 시간**: 9-13시간

## 🎯 **성공 기준**

1. ✅ 수업 카드를 TimetableWidget 전체에 드래그하여 추가 가능
2. ✅ 드롭 시 수업 카드의 스케줄 정보 자동 파싱 및 배치
3. ✅ 드래그 앤 드롭 시 시간 충돌 검증 정상 작동
4. ✅ 드래그 앤 드롭 전용 인터페이스로 정상 작동
5. ✅ 직관적이고 반응성 좋은 사용자 경험 제공
6. ✅ 에러 상황에서 명확한 피드백 제공

---

**구현 우선순위**: 높음  
**난이도**: 중간  
**의존성**: react-dnd 라이브러리, 기존 충돌 검증 로직, 클릭 이벤트 제거
